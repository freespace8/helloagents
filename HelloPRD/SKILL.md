---
name: helloprd
description: 撰写/改写高质量 PRD（产品需求文档）并进行需求澄清与验收标准定义。适用于：从零梳理需求、把脑暴/会议纪要/语音转成 PRD、补齐用户故事与 Given/When/Then、拆分 MVP 与优先级(P0/P1/P2)、补齐非功能需求与 KPI、把现有 PRD 重写成工程师可执行版本。触发词示例：PRD、产品需求文档、需求文档、写PRD、需求澄清、MVP、用户故事、验收标准、优先级、KPI。
---

<output_verbosity_spec>
- Phase 1（Discovery）：每轮仅输出：1 句复述 + 1 行质量分（XX/100 + 主要缺口）+ 3-5 个编号问题（1-5）+ 1 句引导（如何回复/如何进入 Phase 2）。
- Phase 2（Markdown PRD）：仅输出完整 PRD 正文；直接从 `# [功能/产品名称] PRD` 开始；不得输出任何前导/过程/结束文字、Phase 标记、解释说明、或代码块围栏。
</output_verbosity_spec>

<design_and_scope_constraints>
- 严格两阶段：Phase 1 Discovery → Phase 2 Markdown PRD。
- 禁止无依据假设；信息缺口必须追问或显式标注“（待确认）”。
- Phase 1 不产出 PRD；只做澄清与边界收敛。
- Phase 2 必须严格使用指定 PRD 结构；不得新增章节标题。
- 用户故事必须包含 Given/When/Then 验收标准（至少覆盖 P0）。
- 所有量化指标（KPI/性能等）必须写清：口径 + 目标值 + 时间线；缺失则标注“（待确认）”。
</design_and_scope_constraints>

<quality_score_spec>
- Phase 1 使用 100 分制评估需求完整度：仅报告“总分 + 1-2 个主要缺口”，不展示细分表格。
- 评分维度（总 100）：
  - 目标用户/使用场景清晰度（20）
  - 痛点与问题陈述（20）
  - 范围边界与不做什么（15）
  - 优先级与取舍（15）
  - 非功能/约束覆盖（15）
  - 成功指标/KPI 可量化（15）
- 分数门槛（默认逻辑）：
  - <70：必须继续追问（优先补齐最低分维度）。
  - 70-89：继续追问；提示“已接近合格”。
  - ≥90：信息充分；提示用户可用确认词进入 Phase 2。
- 用户强行进入 Phase 2（确认词触发）但 <90：允许进入，但必须在 PRD 的「5. 风险、依赖与跟踪」第一条写明：`质量评估：XX/100（低于90，部分信息待确认）`，并在相关条目用“（待确认）”标注缺口。
</quality_score_spec>

<user_updates_spec>
- 仅在阶段切换点给出 1 句确认/说明；避免叙述“正在阅读/正在思考/正在生成”等过程性话术。
- 进入 Phase 2 的确认词仅限：`done` / `完成澄清` / `进入PRD` / `生成PRD`。
- 为避免误触发：仅当用户消息“最后一行”是确认词（忽略前后空格）时，才进入 Phase 2；否则视为普通回答继续 Phase 1。
</user_updates_spec>

<uncertainty_and_ambiguity>
- 默认：信息不足 → 继续追问（不进入 Phase 2）。
- 例外：用户明确要求进入 Phase 2（见上方确认词）→ 允许进入，但所有缺口必须标注“（待确认）”，并在风险/依赖章节明确指出影响。
</uncertainty_and_ambiguity>

# HelloPRD - PRD 写作与需求澄清（两阶段）

## 全局约束（强制）

- 强制约束以文件顶部的 XML 结构块为准（`<output_verbosity_spec>` / `<design_and_scope_constraints>` / `<user_updates_spec>` / `<uncertainty_and_ambiguity>`）。
- Phase 2 确认词：`done` / `完成澄清` / `进入PRD` / `生成PRD`。
- 为避免误触发：仅当用户消息“最后一行”是确认词时，才进入 Phase 2。
- 若上下文缺失或用户材料不全：提示用户补充“初始需求/材料”，避免猜测。

## Phase 1：Discovery（需求澄清）

### 每轮输出规范

- 先用 1 句复述你理解的当前需求（不新增假设）
- 输出 1 行：当前质量分 `XX/100`（主要缺口：…）
- 仅输出 3-5 个问题（问题编号 1-5），覆盖面优先顺序（6 个类别，不等同于问题编号）：
  - 目标用户/使用场景（谁在什么场景用）
  - 核心痛点与现状替代方案（现在怎么做、哪里痛）
  - 范围边界与不做什么（防止 PRD 失控）
  - 优先级取舍与 MVP 定义（P0 只保留“必须”）
  - 关键非功能需求与约束（性能/安全/合规/时间/预算/依赖）
  - 成功指标/KPI（口径+目标值+时间线）
- 内部按 `<quality_score_spec>` 计算质量分；问题优先聚焦最低分维度
- 末尾固定加：请按序号逐一或批量回复这些问题；如需进入 PRD 输出阶段，请在**最后一行**回复 `done`（或等价确认词）。

**示例（仅示意，内容按你的需求替换）：**
我理解你想做的是：……（复述 1 句）
当前质量分：68/100（主要缺口：KPI未量化、非功能约束不全）
1. ……？
2. ……？
3. ……？
请按序号逐一或批量回复这些问题；如需进入 PRD 输出阶段，请在最后一行回复 `done`。

### 结束信号

- 当用户消息最后一行是确认词后进入 Phase 2；如仍有信息缺口，必须标注“（待确认）”，并在风险/依赖章节明确指出影响

## Phase 2：Markdown PRD（严格结构）

### 输出规则（强制）

- 遵循文件顶部 XML 结构块的强制约束输出；Phase 2 必须直接从 `# [功能/产品名称] PRD` 开始
- 若质量分 <90 仍进入 Phase 2：必须在「5. 风险、依赖与跟踪」第一条写明质量评估，并对缺口使用“（待确认）”

### PRD 模板（原样使用）

# [功能/产品名称] PRD

## 1. 概述
- 愿景（1句）
- 问题陈述（痛点 + 量化证据/数据）
- 成功标准（首要KPI + 目标值 + 时间线）

## 2. 用户与需求
- 核心Persona（2-3个，简要描述）
- 关键痛点列表
- 用户故事（As a [persona] I want [feature] so that [benefit]）+ 明确的Given/When/Then验收标准

## 3. 功能清单与优先级
- P0（必须今做，必备）
- P1（应该做，高价值）
- P2（可选，锦上添花）

## 4. 非功能需求
- 性能（响应时间、并发）
- 安全与隐私
- 可扩展性/兼容性
- 其他（国际化、监控、埋点等）

## 5. 风险、依赖与跟踪
- 主要风险 + 缓解措施
- 外部依赖
- 跟踪计划（埋点建议、次要指标）

## 可选：工程交付衔接（仅用户明确要求时）

- 将 PRD 的 P0 用户故事抽取为“工程任务摘要”（每条含验收标准与约束）
- 如需生成 `why.md/how.md/task.md`：建议切换到工程类技能（如 `helloagents` 的 `~plan`）基于 PRD 内容生成可执行方案包
